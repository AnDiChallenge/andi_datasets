<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ANDI - Version changes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<meta property="og:title" content="ANDI - Version changes">
<meta property="og:description" content="This blog recapitulates the main changes of the andi_datasets library.">
<meta property="og:site-name" content="ANDI">
<meta name="twitter:title" content="ANDI - Version changes">
<meta name="twitter:description" content="This blog recapitulates the main changes of the andi_datasets library.">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./figures/logo_noname.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">ANDI</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">
 <span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./lib_nbs/index_docs.html">
 <span class="menu-text">Documentation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./tutorials/index_tutorials.html">
 <span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://andi-app.herokuapp.com/andi_app">
 <span class="menu-text">ANDI interactive tool</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/andichallenge/andi_datasets"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/AndiChallenge"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#section" id="toc-section" class="nav-link active" data-scroll-target="#section"><code>2.0.0</code></a>
  <ul class="collapse">
  <li><a href="#name-change-andi-datasets-is-now-andi_datasets" id="toc-name-change-andi-datasets-is-now-andi_datasets" class="nav-link" data-scroll-target="#name-change-andi-datasets-is-now-andi_datasets">Name change: <code>andi-datasets</code> is now <code>andi_datasets</code></a></li>
  <li><a href="#library-structure" id="toc-library-structure" class="nav-link" data-scroll-target="#library-structure">Library structure</a></li>
  <li><a href="#accessing-diffusion-models" id="toc-accessing-diffusion-models" class="nav-link" data-scroll-target="#accessing-diffusion-models">Accessing diffusion models</a></li>
  <li><a href="#other-changes" id="toc-other-changes" class="nav-link" data-scroll-target="#other-changes">Other changes</a></li>
  </ul></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"><code>2.1.0</code></a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/andichallenge/andi_datasets/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Version changes</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"><code>2.0.0</code></h2>
<p>This blog recapitulates the main changes of the <code>andi_datasets</code> library. These have two goals: simplify and standarize how to access the different available diffusion models, and most importantly, include the diffusion models that will be considered during the second ANDI challenge.</p>
<section id="name-change-andi-datasets-is-now-andi_datasets" class="level3">
<h3 class="anchored" data-anchor-id="name-change-andi-datasets-is-now-andi_datasets">Name change: <code>andi-datasets</code> is now <code>andi_datasets</code></h3>
<p>Using a hyphen in the library’s name carried some problems. Mainly, due how <code>pip</code> and <code>python</code> deal with them. In our case, in order to install the library, you had to use <code>pip install andi-datasets</code> (sadly, the package <code>andi</code> already exists…), but the to import the package, you had to call <code>import andi</code>. This was inconsistent, and carried some other problems, mostly related to the <code>nbdev</code> package (see below). That is way we have changed the name of the package, such that now, it is found in pip as</p>
<p><code>pip install andi_datasets</code></p>
<p>and is imported in <code>python</code> via <code>import andi_datasets</code>.</p>
</section>
<section id="library-structure" class="level3">
<h3 class="anchored" data-anchor-id="library-structure">Library structure</h3>
<p>One of the main changes is that we have switched to a <a href="https://github.com/fastai/nbdev">nbdev</a>-like library, where all the code is developed in notebooks and the compiled into <code>.py</code> files via the ndbev compiler. In terms of the library usage, nothing has really changed (aside of all the listed below), but we find that this way of developing code will help us maintain a better package and ease adding new features.</p>
<p>Then, we have restructured the whole package to accommodate the new diffusion models as well as standarize the use of the library. Here is a little scheme of how the library is organized:</p>
<p><img src="figures/scheme_v1.svg" class="img-fluid"></p>
<p>In summary, the classes <code>datasets_XXX</code> are used to generate, save and load the trajectories generated by the classes <code>models_XXX</code>. These store the diffusion models, either theoretical or phenomenological. The former were used for the ANDI 1 challenge. You can find more details about them in the <a href="https://www.nature.com/articles/s41467-021-26320-w">challenge’s paper</a> or in this <em>updated</em> <a href="./tutorials/challenge_one_datasets.html">notebook tutorial</a>. The latter are the basis of the ANDI 2022 challenge and are simulated by means of fractional brownian motion plus some extra tweaks. You can start playing around with this models and learn from them via this <a href="./tutorials/challenge_two_datasets.html">notebook tutorial</a>.</p>
<p>On the other hand, we have created a completely new class that gathers the generators for the various Challenge datasets. This allows you to generate datasets similar to the ones that will be used in challenge. Note that the one for Challenge 2 is subject to changes!</p>
<p>We have also created a new class, called <code>analysis</code> that allows you to access common analysis methods for diffusion trajectories, as for instance MSD based fittings for the diffusion coefficient and anomalous exponents, calculations of the velocity autocorrelation function,…</p>
<p>Last, we have organized the different auxiliary functions in three files:</p>
<ul>
<li><p><code>utils_videos</code> allows to merge our library with <a href="https://github.com/softmatterlab/DeepTrack2"><code>deeptrack</code></a>. This allows to generate experimentally realistic videos from the trajectories you create with <code>andi-datasets</code>. A tutorial about it can be found in the Tutorials tab.</p></li>
<li><p><code>utils_trajectories</code> gathers all functions related to the creation of trajectories.</p></li>
<li><p><code>utils_challenge</code> gathers all functions needed to correctly prepare the trajectories and its labels for their use in the AnDi Challenge. It also contains the metrics and the evaluators for the second challenge.</p></li>
</ul>
</section>
<section id="accessing-diffusion-models" class="level3">
<h3 class="anchored" data-anchor-id="accessing-diffusion-models">Accessing diffusion models</h3>
<p>To be fair, accessing directly the diffusion models in the last version was a bit messy. That’s what new versions are here for! Let’s focus first on the theoretical models. Now they can simply be from the <code>models_theory</code> class. Their inputs stay the same as before (<code>alpha</code> for anomalous exponent and <code>T</code> for the length of the trajectory). We have added an extra variable to set the dimension of the diffusion easily. To give an example, a 3D trajectory of ATTM can now be easily created using:</p>
<pre><code> from andi_dataset.models_theory import models_theory

 trajectory = models_theory().attm(alpha = 0.8, T = 10, dimension = 3)</code></pre>
<p>Again, more examples on this theoretical models are given in their corresponding <a href="./tutorials/challenge_one_datasets.html">tutorial notebook</a></p>
<p>For the new phenomenological models, it works the same! However, in this case we have a few more parameters than just the anomalous exponent. You can explore them <a href="./tutorials/challenge_two_datasets.html">here</a>.</p>
</section>
<section id="other-changes" class="level3">
<h3 class="anchored" data-anchor-id="other-changes">Other changes</h3>
<ul>
<li>Variable name change in <code>models_theory().create_dataset</code>: <code>N</code> is now <code>N_model</code>. In this way, it is more clear that <code>N_model</code> refers to number of trajectories per model and we use <code>N</code> for total number of trajectories in other functions.</li>
<li>Corrected how noise is applied in Task3. Now the noise is added after the segmentation. This ensures that two subsequent segments don’t have different noises.</li>
<li>Added an extra variable in <code>datasets_challenge().challenge_theory_dataset</code>, <code>return_noise</code> which, if <code>True</code>, makes the function output the noise amplitudes added to each trajectory. This will help users to get all the information they need when creating their datasets.</li>
<li>Change how noise is applied in <code>models_theory.challenge_theory_dataset</code>, such that all components of trajectories with dimension 2 and 3 have the same noise amplitude.</li>
</ul>
</section>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1"><code>2.1.0</code></h2>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>