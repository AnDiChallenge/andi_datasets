<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ANDI - analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta property="og:title" content="ANDI - analysis">
<meta property="og:description" content="source">
<meta property="og:site-name" content="ANDI">
<meta name="twitter:title" content="ANDI - analysis">
<meta name="twitter:description" content="source">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../figures/logos_banners/logo_noname.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ANDI</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../lib_nbs/index_docs.html" aria-current="page">
 <span class="menu-text">Documentation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../tutorials/index_tutorials.html">
 <span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://andi-app.herokuapp.com/andi_app">
 <span class="menu-text">ANDI interactive tool</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/andichallenge/andi_datasets"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/AndiChallenge"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><code>analysis</code></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lib_nbs/index_docs.html" class="sidebar-item-text sidebar-link">Documentation</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">Theory datasets</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lib_nbs/models_theory.html" class="sidebar-item-text sidebar-link"><code>models_theory</code></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lib_nbs/datasets_theory.html" class="sidebar-item-text sidebar-link"><code>datasets_theory</code></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Phenomenological datasets</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lib_nbs/models_phenom.html" class="sidebar-item-text sidebar-link"><code>models_phenom</code></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lib_nbs/datasets_phenom.html" class="sidebar-item-text sidebar-link"><code>datasets_phenom</code></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">ANDI challenge datasets</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lib_nbs/datasets_challenge.html" class="sidebar-item-text sidebar-link"><code>datasets_challenge</code></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lib_nbs/utils_challenge.html" class="sidebar-item-text sidebar-link"><code>utils_challenge</code></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Trajectory analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lib_nbs/analysis.html" class="sidebar-item-text sidebar-link active"><code>analysis</code></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">Helpers</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lib_nbs/utils_trajectories.html" class="sidebar-item-text sidebar-link"><code>utils_trajectories</code></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lib_nbs/utils_videos.html" class="sidebar-item-text sidebar-link"><code>utils_videos</code></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#angle-calculation" id="toc-angle-calculation" class="nav-link active" data-scroll-target="#angle-calculation">Angle calculation</a>
  <ul class="collapse">
  <li><a href="#dataset_angles" id="toc-dataset_angles" class="nav-link" data-scroll-target="#dataset_angles">dataset_angles</a></li>
  <li><a href="#get_angle" id="toc-get_angle" class="nav-link" data-scroll-target="#get_angle">get_angle</a></li>
  </ul></li>
  <li><a href="#msd-based-analysis" id="toc-msd-based-analysis" class="nav-link" data-scroll-target="#msd-based-analysis">MSD based analysis</a>
  <ul class="collapse">
  <li><a href="#msd_analysis" id="toc-msd_analysis" class="nav-link" data-scroll-target="#msd_analysis">msd_analysis</a></li>
  <li><a href="#msd_analysis.tamsd" id="toc-msd_analysis.tamsd" class="nav-link" data-scroll-target="#msd_analysis.tamsd">msd_analysis.tamsd</a></li>
  <li><a href="#msd_analysis.get_diff_coeff" id="toc-msd_analysis.get_diff_coeff" class="nav-link" data-scroll-target="#msd_analysis.get_diff_coeff">msd_analysis.get_diff_coeff</a></li>
  <li><a href="#msd_analysis.get_exponent" id="toc-msd_analysis.get_exponent" class="nav-link" data-scroll-target="#msd_analysis.get_exponent">msd_analysis.get_exponent</a></li>
  </ul></li>
  <li><a href="#velocity-autocorrelation-function-vacf" id="toc-velocity-autocorrelation-function-vacf" class="nav-link" data-scroll-target="#velocity-autocorrelation-function-vacf">Velocity Autocorrelation Function (VACF)</a>
  <ul class="collapse">
  <li><a href="#vacf" id="toc-vacf" class="nav-link" data-scroll-target="#vacf">vacf</a></li>
  </ul></li>
  <li><a href="#convex-hull-analysis" id="toc-convex-hull-analysis" class="nav-link" data-scroll-target="#convex-hull-analysis">Convex hull analysis</a>
  <ul class="collapse">
  <li><a href="#ch_changepoints" id="toc-ch_changepoints" class="nav-link" data-scroll-target="#ch_changepoints">CH_changepoints</a></li>
  </ul></li>
  <li><a href="#cramér-rao-lower-bound" id="toc-cramér-rao-lower-bound" class="nav-link" data-scroll-target="#cramér-rao-lower-bound">Cramér-Rao lower bound</a>
  <ul class="collapse">
  <li><a href="#crlb_d" id="toc-crlb_d" class="nav-link" data-scroll-target="#crlb_d">CRLB_D</a></li>
  <li><a href="#bounds-for-alpha-and-k_alpha-in-fbm" id="toc-bounds-for-alpha-and-k_alpha-in-fbm" class="nav-link" data-scroll-target="#bounds-for-alpha-and-k_alpha-in-fbm">Bounds for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(K_{alpha}\)</span> in FBM</a>
  <ul class="collapse">
  <li><a href="#derivative_covariance_matrix_k_alpha" id="toc-derivative_covariance_matrix_k_alpha" class="nav-link" data-scroll-target="#derivative_covariance_matrix_k_alpha">derivative_covariance_matrix_K_alpha</a></li>
  <li><a href="#derivative_covariance_matrix_alpha" id="toc-derivative_covariance_matrix_alpha" class="nav-link" data-scroll-target="#derivative_covariance_matrix_alpha">derivative_covariance_matrix_alpha</a></li>
  <li><a href="#generate_covariance_matrix" id="toc-generate_covariance_matrix" class="nav-link" data-scroll-target="#generate_covariance_matrix">generate_covariance_matrix</a></li>
  <li><a href="#fisher_information_matrix" id="toc-fisher_information_matrix" class="nav-link" data-scroll-target="#fisher_information_matrix">fisher_information_matrix</a></li>
  <li><a href="#fisher_information_cross" id="toc-fisher_information_cross" class="nav-link" data-scroll-target="#fisher_information_cross">fisher_information_cross</a></li>
  <li><a href="#fisher_information_k_alpha" id="toc-fisher_information_k_alpha" class="nav-link" data-scroll-target="#fisher_information_k_alpha">fisher_information_K_alpha</a></li>
  <li><a href="#fisher_information_alpha" id="toc-fisher_information_alpha" class="nav-link" data-scroll-target="#fisher_information_alpha">fisher_information_alpha</a></li>
  <li><a href="#example-crlb-of-alpha-for-unknown-and-known-k_alpha" id="toc-example-crlb-of-alpha-for-unknown-and-known-k_alpha" class="nav-link" data-scroll-target="#example-crlb-of-alpha-for-unknown-and-known-k_alpha">Example: CRLB of <span class="math inline">\(\alpha\)</span> for unknown and known <span class="math inline">\(K_\alpha\)</span></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#p-variation" id="toc-p-variation" class="nav-link" data-scroll-target="#p-variation">p-variation</a>
  <ul class="collapse">
  <li><a href="#p_variation" id="toc-p_variation" class="nav-link" data-scroll-target="#p_variation">p_variation</a></li>
  <li><a href="#p_variation_fbm" id="toc-p_variation_fbm" class="nav-link" data-scroll-target="#p_variation_fbm">p_variation_FBM</a></li>
  <li><a href="#example-1-p-variation-scaling-for-p-2" id="toc-example-1-p-variation-scaling-for-p-2" class="nav-link" data-scroll-target="#example-1-p-variation-scaling-for-p-2">Example 1: p-variation scaling for p = 2</a></li>
  <li><a href="#example-2-theoretical-estiation-of-p-variation-for-fbm-and-p-1h" id="toc-example-2-theoretical-estiation-of-p-variation-for-fbm-and-p-1h" class="nav-link" data-scroll-target="#example-2-theoretical-estiation-of-p-variation-for-fbm-and-p-1h">Example 2: Theoretical estiation of p-variation for FBM and p = 1/H</a></li>
  </ul></li>
  <li><a href="#power-spectral-density" id="toc-power-spectral-density" class="nav-link" data-scroll-target="#power-spectral-density">Power spectral density</a>
  <ul class="collapse">
  <li><a href="#psd" id="toc-psd" class="nav-link" data-scroll-target="#psd">psd</a></li>
  <li><a href="#example-from-clean-to-noisy-trajectories" id="toc-example-from-clean-to-noisy-trajectories" class="nav-link" data-scroll-target="#example-from-clean-to-noisy-trajectories">Example: from clean to noisy trajectories</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/andichallenge/andi_datasets/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><code>analysis</code></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="angle-calculation" class="level1">
<h1>Angle calculation</h1>
<hr>
<p><a href="https://github.com/andichallenge/andi_datasets/blob/master/andi_datasets/analysis.py#L23" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="dataset_angles" class="level3">
<h3 class="anchored" data-anchor-id="dataset_angles">dataset_angles</h3>
<blockquote class="blockquote">
<pre><code> dataset_angles (trajs:list)</code></pre>
</blockquote>
<p>Given a set of trajectories, calculate all angles between displacements</p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>trajs</td>
<td>list</td>
<td>set of trajectories from which to calculate angles</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>list</strong></td>
<td><strong>list of angles between displacements</strong></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/andichallenge/andi_datasets/blob/master/andi_datasets/analysis.py#L14" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_angle" class="level3">
<h3 class="anchored" data-anchor-id="get_angle">get_angle</h3>
<blockquote class="blockquote">
<pre><code> get_angle (a:tuple, b:tuple, c:tuple)</code></pre>
</blockquote>
<p>Calculates the angle between the segments generate by three points</p>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a</td>
<td>tuple</td>
<td>2d position point A</td>
</tr>
<tr class="even">
<td>b</td>
<td>tuple</td>
<td>2d position point B</td>
</tr>
<tr class="odd">
<td>c</td>
<td>tuple</td>
<td>2d position point C</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>tuple</strong></td>
<td><strong>angle between segments AB and BC points</strong></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="msd-based-analysis" class="level1">
<h1>MSD based analysis</h1>
<hr>
<p><a href="https://github.com/andichallenge/andi_datasets/blob/master/andi_datasets/analysis.py#L33" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="msd_analysis" class="level3">
<h3 class="anchored" data-anchor-id="msd_analysis">msd_analysis</h3>
<blockquote class="blockquote">
<pre><code> msd_analysis ()</code></pre>
</blockquote>
<p>Contains mean squared displacement (MSD) based methods to analyze trajectories.</p>
<hr>
<p><a href="https://github.com/andichallenge/andi_datasets/blob/master/andi_datasets/analysis.py#L38" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="msd_analysis.tamsd" class="level3">
<h3 class="anchored" data-anchor-id="msd_analysis.tamsd">msd_analysis.tamsd</h3>
<blockquote class="blockquote">
<pre><code> msd_analysis.tamsd (trajs:numpy.ndarray, t_lags:numpy.ndarray, dim=1)</code></pre>
</blockquote>
<p>Calculates the time average mean squared displacement (TA-MSD) of a trajectory at various time lags,</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>trajs</td>
<td>ndarray</td>
<td></td>
<td>Set of trajectories of dimenions NxTxD (N: number of trajectories, T: lenght, D: dimension)</td>
</tr>
<tr class="even">
<td>t_lags</td>
<td>ndarray</td>
<td></td>
<td>Time lags used for the TA-MSD</td>
</tr>
<tr class="odd">
<td>dim</td>
<td>int</td>
<td>1</td>
<td>Dimension of the trajectories (currently only 1 and 2 supported)</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>np.array</strong></td>
<td></td>
<td><strong>TA-MSD of each trayectory / t_lag</strong></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/andichallenge/andi_datasets/blob/master/andi_datasets/analysis.py#L71" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="msd_analysis.get_diff_coeff" class="level3">
<h3 class="anchored" data-anchor-id="msd_analysis.get_diff_coeff">msd_analysis.get_diff_coeff</h3>
<blockquote class="blockquote">
<pre><code> msd_analysis.get_diff_coeff (trajs:numpy.ndarray, t_lags:list=None)</code></pre>
</blockquote>
<p>Calculates the diffusion coefficient of a trajectory by means of the linear fitting of the TA-MSD.</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>trajs</td>
<td>ndarray</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>t_lags</td>
<td>list</td>
<td>None</td>
<td>Time lags used for the TA-MSD.</td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>np.array</strong></td>
<td></td>
<td><strong>Diffusion coefficient of the given trajectory. </strong></td>
</tr>
</tbody>
</table>
<p>Here we show an example for the calculation of the diffusion coefficient of a 2D Brownian motion trajectory. We create trajectories from displacements of variance <span class="math inline">\(\sigma =1\)</span>, which results in a diffusion coefficient <span class="math inline">\(D=0.5\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pos <span class="op">=</span> np.cumsum(np.random.randn(<span class="dv">1070</span>, <span class="dv">100</span>, <span class="dv">2</span>), axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>D <span class="op">=</span> msd_analysis().get_diff_coeff(pos)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>plt.hist(D, bins <span class="op">=</span> <span class="dv">30</span>)<span class="op">;</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>plt.axvline(np.mean(D), c <span class="op">=</span> <span class="st">'k'</span>, label <span class="op">=</span> <span class="ss">f'Mean of predictions = </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">round</span>(np.mean(D), <span class="dv">2</span>)<span class="sc">}</span><span class="ss">'</span>)                                                                  </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>plt.axvline(<span class="fl">0.5</span>, c <span class="op">=</span> <span class="st">'r'</span>, ls <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="st">'Expected'</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;matplotlib.legend.Legend&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="analysis_files/figure-html/cell-7-output-2.png" class="img-fluid"></p>
</div>
</div>
<hr>
<p><a href="https://github.com/andichallenge/andi_datasets/blob/master/andi_datasets/analysis.py#L105" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="msd_analysis.get_exponent" class="level3">
<h3 class="anchored" data-anchor-id="msd_analysis.get_exponent">msd_analysis.get_exponent</h3>
<blockquote class="blockquote">
<pre><code> msd_analysis.get_exponent (trajs:numpy.ndarray, t_lags:list=None)</code></pre>
</blockquote>
<p>Calculates the diffusion coefficient of a trajectory by means of the linear fitting of the TA-MSD.</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>trajs</td>
<td>ndarray</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>t_lags</td>
<td>list</td>
<td>None</td>
<td>Time lags used for the TA-MSD.</td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>np.array</strong></td>
<td></td>
<td><strong>Diffusion coefficient of the given trajectory. </strong></td>
</tr>
</tbody>
</table>
<p>To showcase this function, we generate fractional brownian motion trajectories with <span class="math inline">\(\alpha = 0.5\)</span> and calculate their exponent:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>trajs, _ <span class="op">=</span> models_phenom().single_state(N <span class="op">=</span> <span class="dv">1001</span>, T <span class="op">=</span> <span class="dv">100</span>, alphas <span class="op">=</span> <span class="fl">0.5</span>, dim <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> msd_analysis().get_exponent(trajs.transpose(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">2</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>plt.hist(alpha, bins <span class="op">=</span> <span class="dv">30</span>)<span class="op">;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>plt.axvline(np.mean(alpha), c <span class="op">=</span> <span class="st">'k'</span>, label <span class="op">=</span> <span class="ss">f'Mean of predictions = </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">round</span>(np.mean(alpha), <span class="dv">2</span>)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>plt.axvline(<span class="fl">0.5</span>, c <span class="op">=</span> <span class="st">'r'</span>, ls <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="st">'Expected'</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(1001, 100, 2)</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;matplotlib.legend.Legend&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="analysis_files/figure-html/cell-9-output-3.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="velocity-autocorrelation-function-vacf" class="level1">
<h1>Velocity Autocorrelation Function (VACF)</h1>
<hr>
<p><a href="https://github.com/andichallenge/andi_datasets/blob/master/andi_datasets/analysis.py#L186" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="vacf" class="level3">
<h3 class="anchored" data-anchor-id="vacf">vacf</h3>
<blockquote class="blockquote">
<pre><code> vacf (trajs, delta_t:int|list|numpy.ndarray=1,
       taus:bool|list|numpy.ndarray=None)</code></pre>
</blockquote>
<p>Calculates the velocity autocorrelation function for the given set of trajectories.</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>trajs</td>
<td>np.array</td>
<td></td>
<td>NxT matrix containing N trajectories of length T.</td>
</tr>
<tr class="even">
<td>delta_t</td>
<td>int | list | numpy.ndarray</td>
<td>1</td>
<td>If not None, the vacf is calculated in the demanded time lags.</td>
</tr>
<tr class="odd">
<td>taus</td>
<td>bool | list | numpy.ndarray</td>
<td>None</td>
<td>Time windows at wich the vacf is calculated.</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>np.array</strong></td>
<td></td>
<td><strong>VACF of the given trajectories and the given time windows. </strong></td>
</tr>
</tbody>
</table>
<p>We show here an example of the VACF for FBM trajectories at various time lages, showing that they all coincide (as expected for this diffusion model).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>deltats <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">5</span>).tolist()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>taus <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>trajs, _ <span class="op">=</span> models_phenom().single_state(N <span class="op">=</span> <span class="dv">200</span>, T <span class="op">=</span> <span class="dv">200</span>, alphas <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>trajs <span class="op">=</span> trajs.transpose(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>)[:,:,<span class="dv">0</span>]</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> deltat <span class="kw">in</span> deltats:  </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> vacf(trajs, deltat, taus)        </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    plt.plot(taus<span class="op">/</span>deltat, v.flatten(), <span class="st">'o-'</span>, alpha <span class="op">=</span> <span class="fl">0.4</span>)    </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="op">-</span><span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'VACF'</span>)<span class="op">;</span> plt.xlabel(<span class="vs">r'$\tau / \delta$'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Text(0.5, 0, '$\\tau / \\delta$')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="analysis_files/figure-html/cell-11-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="convex-hull-analysis" class="level1">
<h1>Convex hull analysis</h1>
<hr>
<p><a href="https://github.com/andichallenge/andi_datasets/blob/master/andi_datasets/analysis.py#L232" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="ch_changepoints" class="level3">
<h3 class="anchored" data-anchor-id="ch_changepoints">CH_changepoints</h3>
<blockquote class="blockquote">
<pre><code> CH_changepoints (trajs, tau:int=10, metric:{'volume','area'}='volume')</code></pre>
</blockquote>
<p>Computes the changes points a multistate trajectory based on the Convex Hull approach proposed in PRE 96 (022144), 2017.</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>trajs</td>
<td>np.array</td>
<td></td>
<td>NxT matrix containing N trajectories of length T.</td>
</tr>
<tr class="even">
<td>tau</td>
<td>int</td>
<td>10</td>
<td>Time window over which the CH is calculated.</td>
</tr>
<tr class="odd">
<td>metric</td>
<td>{‘volume’, ‘area’}</td>
<td>volume</td>
<td>Calculate change points w.r.t. area or volume of CH.</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>list</strong></td>
<td></td>
<td><strong>Change points of the given trajectory.</strong></td>
</tr>
</tbody>
</table>
<p>We showcase the use of the convex hull in a Brownian motion trajectory with two distinct diffusion coefficients, one 10 times the other:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate trajectories and plot change points</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="dv">100</span><span class="op">;</span> on <span class="op">=</span> <span class="dv">40</span><span class="op">;</span> off <span class="op">=</span> <span class="dv">60</span><span class="op">;</span> tau <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>traj <span class="op">=</span> np.random.randn(T, <span class="dv">2</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>traj[on:off, :] <span class="op">=</span> traj[on:off, :]<span class="op">*</span><span class="dv">10</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>traj <span class="op">=</span> traj.cumsum(<span class="dv">0</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>plt.axvline(on<span class="op">-</span>tau, c <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(off<span class="op">-</span>tau, c <span class="op">=</span> <span class="st">'k'</span>, label <span class="op">=</span> <span class="st">'True change points'</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate variable Sd </span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>Sd <span class="op">=</span> np.zeros(traj.shape[<span class="dv">0</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>tau)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(traj.shape[<span class="dv">0</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>tau):       </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    Sd[k] <span class="op">=</span> ConvexHull(traj[k:(k<span class="op">+</span><span class="dv">2</span><span class="op">*</span>tau)], ).volume  </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute change points both with volume and area</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>CPs <span class="op">=</span> CH_changepoints([traj], tau <span class="op">=</span> tau)[<span class="dv">0</span>].flatten()<span class="op">-</span>tau</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>CPs_a <span class="op">=</span> CH_changepoints([traj], tau <span class="op">=</span> tau, metric <span class="op">=</span> <span class="st">'area'</span>)[<span class="dv">0</span>].flatten()<span class="op">-</span>tau</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot everything</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>label_cp <span class="op">=</span> <span class="st">'CH Volume'</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> cp <span class="kw">in</span> CPs:</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    plt.axvline(cp, c <span class="op">=</span> <span class="st">'g'</span>, alpha <span class="op">=</span> <span class="fl">0.8</span>, ls <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> label_cp)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    label_cp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>label_cp <span class="op">=</span> <span class="st">'CH Area'</span>    </span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> cp <span class="kw">in</span> CPs_a:</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    plt.axvline(cp, alpha <span class="op">=</span> <span class="fl">0.8</span>, ls <span class="op">=</span> <span class="st">'--'</span>, c <span class="op">=</span> <span class="st">'orange'</span>, label <span class="op">=</span> label_cp)</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    label_cp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>plt.plot(Sd, <span class="st">'-o'</span>)</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>plt.axhline(Sd.mean(), label <span class="op">=</span> <span class="st">'CH Volume mean'</span>, c <span class="op">=</span> <span class="st">'g'</span>,)</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'n'</span>)<span class="op">;</span> plt.ylabel(<span class="vs">r'$S_d(n)$'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Text(0, 0.5, '$S_d(n)$')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="analysis_files/figure-html/cell-13-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="cramér-rao-lower-bound" class="level1">
<h1>Cramér-Rao lower bound</h1>
<blockquote class="blockquote">
<p>Expressions of the CRLB for the estimation of the diffusion coefficient for trajectories without noise, for dimension 1 and 2, at different trajectory lengths</p>
</blockquote>
<hr>
<p><a href="https://github.com/andichallenge/andi_datasets/blob/master/andi_datasets/analysis.py#L273" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="crlb_d" class="level3">
<h3 class="anchored" data-anchor-id="crlb_d">CRLB_D</h3>
<blockquote class="blockquote">
<pre><code> CRLB_D (T:int, dim:int=1)</code></pre>
</blockquote>
<p>Returns the Cramer-Rao lower bound S(D)/D for Brownian motion without noise, namely</p>
<p>S(D) / D = sqrt(2 / (d·T) )</p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>T</td>
<td>int</td>
<td></td>
<td>Length of the trajectory</td>
</tr>
<tr class="even">
<td>dim</td>
<td>int</td>
<td>1</td>
<td>Dimension of the trajectoy</td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>float</strong></td>
<td></td>
<td><strong>Cramér-Rao bound</strong></td>
</tr>
</tbody>
</table>
<p>Here we show how for Brownian motion trajectories, the MSD with is <em>nearly</em> optimal and follows the same scaling as the CRLB (i.e.&nbsp;<span class="math inline">\(S(D)/D = \sqrt(6/T)\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>Ts <span class="op">=</span> np.logspace(<span class="dv">1</span>, <span class="dv">3</span>,<span class="dv">20</span>).astype(<span class="bu">int</span>) <span class="co"># Trajectory lengths</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>Ds <span class="op">=</span> np.arange(<span class="fl">0.5</span>, <span class="fl">2.1</span>, <span class="fl">0.5</span>) <span class="co"># We will test on different diffusion coefficients</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the standard deviations</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>std_ds <span class="op">=</span> np.zeros((<span class="bu">len</span>(Ds), <span class="bu">len</span>(Ts)))</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idxD, D <span class="kw">in</span> <span class="bu">enumerate</span>(tqdm(Ds)):</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate the BM trajectories with given parameters</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    trajs <span class="op">=</span> (np.sqrt(<span class="dv">2</span><span class="op">*</span>D)<span class="op">*</span>np.random.randn(<span class="bu">int</span>(<span class="fl">1e4</span>), Ts[<span class="op">-</span><span class="dv">1</span>], <span class="dv">1</span>)).cumsum(<span class="dv">1</span>) </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idxL, T <span class="kw">in</span> <span class="bu">enumerate</span>(tqdm(Ts)):</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>        std_ds[idxD, idxL] <span class="op">=</span> np.array(msd_analysis().get_diff_coeff(trajs <span class="op">=</span> trajs[:, :T], t_lags <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">2</span>])).std()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ce06d21fdfda4bca901283b4632be192","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4ad59e51d0a248a3a2e08069a681c923","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ccdcaac7bb0f4216a62cb56824809c59","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"322dfa6efd3348dda8a7bbc0dc4a1d93","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"93347d52236a474a985a4ac9ff00b0b6","version_major":2,"version_minor":0}
</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">4</span>, figsize <span class="op">=</span> (<span class="dv">4</span><span class="op">*</span><span class="dv">3</span>,<span class="dv">3</span>), tight_layout <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, (ax, std_d, D) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(axs.flatten(), std_ds, Ds)):</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    ax.scatter(Ts, std_d<span class="op">/</span>D, label <span class="op">=</span> <span class="vs">r'MSD$_{1-2}$'</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    ax.loglog(Ts, np.sqrt(<span class="dv">6</span><span class="op">/</span>Ts), label <span class="op">=</span> <span class="st">'Predicted std for MSD'</span>, alpha <span class="op">=</span> <span class="fl">0.9</span>, c <span class="op">=</span> <span class="st">'C1'</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    ax.loglog(Ts, CRLB_D(Ts), label <span class="op">=</span> <span class="st">'Cramer-Rao bound'</span>, alpha <span class="op">=</span> <span class="fl">0.9</span>, c <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="vs">fr'$D = </span><span class="sc">{</span>D<span class="sc">}</span><span class="vs">$'</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].legend()</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>plt.setp(axs[<span class="dv">0</span>], ylabel <span class="op">=</span> <span class="st">'std(D) / D'</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>plt.setp(axs, xlabel <span class="op">=</span> <span class="st">'Traj. length'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="analysis_files/figure-html/cell-16-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="bounds-for-alpha-and-k_alpha-in-fbm" class="level2">
<h2 class="anchored" data-anchor-id="bounds-for-alpha-and-k_alpha-in-fbm">Bounds for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(K_{alpha}\)</span> in FBM</h2>
<hr>
<p><a href="https://github.com/andichallenge/andi_datasets/blob/master/andi_datasets/analysis.py#L318" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="derivative_covariance_matrix_k_alpha" class="level3">
<h3 class="anchored" data-anchor-id="derivative_covariance_matrix_k_alpha">derivative_covariance_matrix_K_alpha</h3>
<blockquote class="blockquote">
<pre><code> derivative_covariance_matrix_K_alpha (alpha, K_alpha, N, delta_t=1.0)</code></pre>
</blockquote>
<p>Calculate the derivative of the covariance matrix with respect to K_alpha.</p>
<hr>
<p><a href="https://github.com/andichallenge/andi_datasets/blob/master/andi_datasets/analysis.py#L300" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="derivative_covariance_matrix_alpha" class="level3">
<h3 class="anchored" data-anchor-id="derivative_covariance_matrix_alpha">derivative_covariance_matrix_alpha</h3>
<blockquote class="blockquote">
<pre><code> derivative_covariance_matrix_alpha (alpha, K_alpha, N, delta_t=1.0)</code></pre>
</blockquote>
<p>Calculate the derivative of the covariance matrix with respect to alpha using vectorized operations.</p>
<hr>
<p><a href="https://github.com/andichallenge/andi_datasets/blob/master/andi_datasets/analysis.py#L284" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="generate_covariance_matrix" class="level3">
<h3 class="anchored" data-anchor-id="generate_covariance_matrix">generate_covariance_matrix</h3>
<blockquote class="blockquote">
<pre><code> generate_covariance_matrix (alpha, K_alpha, N, delta_t=1.0)</code></pre>
</blockquote>
<p>Generate the covariance matrix for FBM using vectorized operations.</p>
<hr>
<p><a href="https://github.com/andichallenge/andi_datasets/blob/master/andi_datasets/analysis.py#L364" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="fisher_information_matrix" class="level3">
<h3 class="anchored" data-anchor-id="fisher_information_matrix">fisher_information_matrix</h3>
<blockquote class="blockquote">
<pre><code> fisher_information_matrix (alpha, K_alpha, N, delta_t=1.0)</code></pre>
</blockquote>
<p>Calculate the full Fisher Information Matrix and its inverse.</p>
<hr>
<p><a href="https://github.com/andichallenge/andi_datasets/blob/master/andi_datasets/analysis.py#L351" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="fisher_information_cross" class="level3">
<h3 class="anchored" data-anchor-id="fisher_information_cross">fisher_information_cross</h3>
<blockquote class="blockquote">
<pre><code> fisher_information_cross (alpha, K_alpha, N, delta_t=1.0)</code></pre>
</blockquote>
<p>Calculate the Fisher Information cross term I_alpha,K_alpha.</p>
<hr>
<p><a href="https://github.com/andichallenge/andi_datasets/blob/master/andi_datasets/analysis.py#L344" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="fisher_information_k_alpha" class="level3">
<h3 class="anchored" data-anchor-id="fisher_information_k_alpha">fisher_information_K_alpha</h3>
<blockquote class="blockquote">
<pre><code> fisher_information_K_alpha (K_alpha, N, delta_t=1.0)</code></pre>
</blockquote>
<p>Calculate the Fisher Information component I_K_alpha,K_alpha.</p>
<p>In this case, it can be analytically calculate as N/(2*K_alpha**2)</p>
<hr>
<p><a href="https://github.com/andichallenge/andi_datasets/blob/master/andi_datasets/analysis.py#L327" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="fisher_information_alpha" class="level3">
<h3 class="anchored" data-anchor-id="fisher_information_alpha">fisher_information_alpha</h3>
<blockquote class="blockquote">
<pre><code> fisher_information_alpha (alpha, N, delta_t=1.0)</code></pre>
</blockquote>
<p>Calculate the Fisher Information component I_alpha,alpha.</p>
</section>
<section id="example-crlb-of-alpha-for-unknown-and-known-k_alpha" class="level3">
<h3 class="anchored" data-anchor-id="example-crlb-of-alpha-for-unknown-and-known-k_alpha">Example: CRLB of <span class="math inline">\(\alpha\)</span> for unknown and known <span class="math inline">\(K_\alpha\)</span></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example parameters</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>alphas <span class="op">=</span> np.linspace(<span class="fl">0.1</span>, <span class="fl">1.9</span>, <span class="dv">50</span>) <span class="co"># anomalous exponent to check</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="dv">100</span>  <span class="co"># Length of the trajectory</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>K_alpha <span class="op">=</span> <span class="dv">1</span> <span class="co"># diffusion coefficient (note that these results are independnet of K_alpha)</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance with known K_alpha (i.e. inverse of diagonal term of the Fisher information matrix)</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>var_a_k <span class="op">=</span> np.array([<span class="dv">1</span><span class="op">/</span>fisher_information_alpha(alpha, T) <span class="cf">for</span> alpha <span class="kw">in</span> alphas])</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance with unknown K_alpha (i.e. diagonal term of the inverse of the full Fisher information matrix)</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>var_a_uk <span class="op">=</span> np.array([fisher_information_matrix(alpha, K_alpha, T)[<span class="dv">1</span>][<span class="dv">0</span>,<span class="dv">0</span>] <span class="cf">for</span> alpha <span class="kw">in</span> alphas])</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>plt.plot(alphas, var_a_k, c <span class="op">=</span> <span class="st">'#003f5c'</span>, lw <span class="op">=</span> <span class="dv">2</span>, label <span class="op">=</span> <span class="vs">r'Known $K_\alpha$'</span>)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>plt.plot(alphas, var_a_uk, c <span class="op">=</span> <span class="st">'#ffbf00'</span>, lw <span class="op">=</span> <span class="dv">2</span>, label <span class="op">=</span> <span class="vs">r'Unknown $K_\alpha$'</span>)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>plt.plot(alphas, var_a_uk<span class="op">-</span>var_a_k, c <span class="op">=</span> <span class="st">'#a3a3a3'</span>, ls <span class="op">=</span> <span class="st">'--'</span>, label <span class="op">=</span> <span class="st">'Difference'</span>)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha <span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="vs">r'$\alpha$'</span>)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;matplotlib.legend.Legend&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="analysis_files/figure-html/cell-24-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
</section>
<section id="p-variation" class="level1">
<h1>p-variation</h1>
<hr>
<p><a href="https://github.com/andichallenge/andi_datasets/blob/master/andi_datasets/analysis.py#L380" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="p_variation" class="level3">
<h3 class="anchored" data-anchor-id="p_variation">p_variation</h3>
<blockquote class="blockquote">
<pre><code> p_variation (traj:&lt;built-infunctionarray&gt;, m:int, p:int)</code></pre>
</blockquote>
<p>Given a trajectory, computes the p-variation for the given lag m and variation p.</p>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>traj</td>
<td>array</td>
<td>Trajectory for which to compute the p-variation</td>
</tr>
<tr class="even">
<td>m</td>
<td>int</td>
<td>Time lag between positions considered in the p-variation (see Eq. (8) of https://doi.org/10.1103/PhysRevE.82.021130)</td>
</tr>
<tr class="odd">
<td>p</td>
<td>int</td>
<td>Integer defining the p-variation</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>array</strong></td>
<td><strong>p-variation of the current trajectory</strong></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/andichallenge/andi_datasets/blob/master/andi_datasets/analysis.py#L404" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="p_variation_fbm" class="level3">
<h3 class="anchored" data-anchor-id="p_variation_fbm">p_variation_FBM</h3>
<blockquote class="blockquote">
<pre><code> p_variation_FBM (H:float, sigma:float, t:&lt;built-infunctionarray&gt;)</code></pre>
</blockquote>
<p>Given a Hurst exponent and the std of a FBM process with MSD = sigma^2 t^(2H), computes the predicted p-variation:</p>
<p>p^(1/H) (t) = E(|B(1)|^(1/H))</p>
<p>See more at Eq. (8) in https://doi.org/10.1103/PhysRevE.82.011129</p>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>H</td>
<td>float</td>
<td>Hurst exponent</td>
</tr>
<tr class="even">
<td>sigma</td>
<td>float</td>
<td>Standard deviation of the FBM process</td>
</tr>
<tr class="odd">
<td>t</td>
<td>array</td>
<td>times for which to compute p^(1/H) (t)</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>array</strong></td>
<td><strong>Theoretical prediction for the p^(1/H) (t)</strong></td>
</tr>
</tbody>
</table>
</section>
<section id="example-1-p-variation-scaling-for-p-2" class="level2">
<h2 class="anchored" data-anchor-id="example-1-p-variation-scaling-for-p-2">Example 1: p-variation scaling for p = 2</h2>
<p>In the case of <code>p = 2</code>, based on <a href="http://dx.doi.org/10.1103/PhysRevLett.103.180602">[1]</a>:</p>
<ul>
<li>For FBM: we should have an increasing p-variation with bigger resolution (in the paper it means increasing n in Eq.(5) but in the discrete version used here it means decreasing <code>m</code> (see Eq. (8) of <a href="https://doi.org/10.1103/PhysRevE.82.021130">[2]</a>).</li>
<li>For CTRW: the p-variation should estabilize to a value given [1] (i.e smaller <code>m</code> should start converging to this stable value).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="dv">5000</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> <span class="fl">0.2</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>fbm_traj <span class="op">=</span> models_theory().fbm(alpha <span class="op">=</span> H<span class="op">*</span><span class="dv">2</span>, T <span class="op">=</span> T)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>ctrw_traj <span class="op">=</span> models_theory().ctrw(alpha <span class="op">=</span> H<span class="op">*</span><span class="dv">2</span>, T <span class="op">=</span> T)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">7</span>,<span class="dv">3</span>))</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> m <span class="kw">in</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>]:</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    pvar_fbm <span class="op">=</span> p_variation(fbm_traj, p <span class="op">=</span> <span class="dv">2</span>, m <span class="op">=</span> m)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    pvar_ctrw <span class="op">=</span> p_variation(ctrw_traj, p <span class="op">=</span> <span class="dv">2</span>, m <span class="op">=</span> m)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">0</span>].plot(np.arange(T), pvar_fbm, label <span class="op">=</span> m)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">1</span>].plot(np.arange(T), pvar_ctrw, label <span class="op">=</span> m)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].legend(title <span class="op">=</span> <span class="st">'m'</span>)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">'p-variation (p = 2)'</span>)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>plt.setp(ax, xlabel <span class="op">=</span> <span class="st">'Time'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="analysis_files/figure-html/cell-27-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="example-2-theoretical-estiation-of-p-variation-for-fbm-and-p-1h" class="level2">
<h2 class="anchored" data-anchor-id="example-2-theoretical-estiation-of-p-variation-for-fbm-and-p-1h">Example 2: Theoretical estiation of p-variation for FBM and p = 1/H</h2>
<p>In the case of <code>p = 1/H</code>, with <code>H</code> being the Hurst exponent, we can theoretically calculated the value of the p-variation for an FBM process (see Eq. (6) of <a href="http://dx.doi.org/10.1103/PhysRevLett.103.180602">1</a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="dv">5000</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>pvar_alpha <span class="op">=</span> []</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>Hs <span class="op">=</span> np.linspace(<span class="fl">0.2</span>,<span class="fl">0.5</span>,<span class="dv">5</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>pvars <span class="op">=</span> []</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>pvars_t <span class="op">=</span> []</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>Ds_est <span class="op">=</span> []</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>min_idx <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idxH, H <span class="kw">in</span> <span class="bu">enumerate</span>(Hs): </span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We create a trajectory with fixed D = 1</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    traj <span class="op">=</span> np.cumsum(models_phenom().disp_fbm(D <span class="op">=</span> <span class="dv">1</span>, alpha <span class="op">=</span> H<span class="op">*</span><span class="dv">2</span>, T <span class="op">=</span> T))</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    pvar <span class="op">=</span> p_variation(traj, p <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>H, m <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    pvar_theory <span class="op">=</span> p_variation_FBM(H <span class="op">=</span> H, </span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>                                  sigma <span class="op">=</span> np.sqrt(<span class="dv">2</span>), <span class="co"># Note that definition of diffusion coefficient is different </span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>                                                      <span class="co"># for models_phenom and this function, hence introducint a sqrt(2) factor</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>                                  t <span class="op">=</span> np.arange(T))</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>    plt.loglog(np.arange(T)[min_idx:], pvar[min_idx:], label <span class="op">=</span> <span class="st">'Numerical calculation'</span> <span class="cf">if</span> idxH <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">''</span>)</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>    plt.plot(np.arange(T)[min_idx:], pvar_theory[min_idx:], label <span class="op">=</span> <span class="st">'Theoretical prediction'</span> <span class="cf">if</span> idxH <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">''</span>,</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>             c <span class="op">=</span> <span class="ss">f'C</span><span class="sc">{</span>idxH<span class="sc">}</span><span class="ss">'</span>, ls <span class="op">=</span> <span class="st">'--'</span>, alpha <span class="op">=</span> <span class="fl">0.6</span>)</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'p-variation (p = 1/H)'</span>)</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Time'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Text(0.5, 0, 'Time')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="analysis_files/figure-html/cell-28-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="power-spectral-density" class="level1">
<h1>Power spectral density</h1>
<hr>
<p><a href="https://github.com/andichallenge/andi_datasets/blob/master/andi_datasets/analysis.py#L422" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="psd" class="level3">
<h3 class="anchored" data-anchor-id="psd">psd</h3>
<blockquote class="blockquote">
<pre><code> psd (traj:numpy.ndarray)</code></pre>
</blockquote>
<p>Calculates the approximate power spectral density based on scipy.periodogram</p>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>traj</td>
<td>ndarray</td>
<td>Trajectory of size (T,) (i.e.&nbsp;1D) or (T, dim)</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>tuple</strong></td>
<td><strong>(f, psd): frequencies f and power spectral density. Sizes f: (floor(T/2)), psd: (floor(T/2))</strong></td>
</tr>
</tbody>
</table>
</section>
<section id="example-from-clean-to-noisy-trajectories" class="level3">
<h3 class="anchored" data-anchor-id="example-from-clean-to-noisy-trajectories">Example: from clean to noisy trajectories</h3>
<p>In this example we show how to use the PSD and also how the noise present in the trajectories can affect this assesment. This is based on the result of <a href="https://www.nature.com/articles/s42005-022-01079-8">“Towards a robust criterion of anomalous diffusion”, V. Sposini et al.</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="bu">int</span>(<span class="fl">1e5</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="bu">int</span>(<span class="fl">1e4</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Hurst exponents we will consider</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>Hs <span class="op">=</span> np.array([<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span><span class="op">/</span><span class="dv">2</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Storing variables</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co"># mean and std of the PSD for the clean trajectories</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>muH <span class="op">=</span> np.zeros((<span class="bu">len</span>(Hs), <span class="bu">int</span>(T<span class="op">/</span><span class="dv">2</span>)))</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>stdH <span class="op">=</span> np.zeros_like(muH)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co"># mean and std of the PSD for the noise trajectories</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>muH_noise <span class="op">=</span> np.zeros_like(muH)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>stdH_noise <span class="op">=</span> np.zeros_like(muH)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>sigma_noise <span class="op">=</span> <span class="fl">1e2</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idxH, H <span class="kw">in</span> <span class="bu">enumerate</span>(tqdm(Hs)):</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    psdH <span class="op">=</span> np.zeros((N, <span class="bu">int</span>(T<span class="op">/</span><span class="dv">2</span>)))</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    psdH_noise <span class="op">=</span> np.zeros((N, <span class="bu">int</span>(T<span class="op">/</span><span class="dv">2</span>)))</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idxN <span class="kw">in</span> (<span class="bu">range</span>(N)):</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Here we generate the clean trajectories and compute their PSD</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>        X <span class="op">=</span> models_phenom().disp_fbm(D <span class="op">=</span> <span class="dv">1</span>, alpha <span class="op">=</span> H<span class="op">*</span><span class="dv">2</span>, T <span class="op">=</span> T).cumsum()</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>        f, psd <span class="op">=</span> periodogram(X)</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>        psdH[idxN] <span class="op">=</span> psd[<span class="dv">1</span>:]</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Now we noise the trajectories and compute their new PSD</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>        X_noise <span class="op">=</span> X <span class="op">+</span> np.random.randn(X.shape[<span class="dv">0</span>])<span class="op">*</span>np.sqrt(sigma_noise)</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>        _, psd_noise <span class="op">=</span> periodogram(X_noise)</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>        psdH_noise[idxN] <span class="op">=</span> psd_noise[<span class="dv">1</span>:]</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>    muH[idxH] <span class="op">=</span> psdH.mean(<span class="dv">0</span>)</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>    stdH[idxH] <span class="op">=</span> psdH.std(<span class="dv">0</span>)</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>    muH_noise[idxH] <span class="op">=</span> psdH_noise.mean(<span class="dv">0</span>)</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>    stdH_noise[idxH] <span class="op">=</span> psdH_noise.std(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d97f77e15011462289a088009c13bcca","version_major":2,"version_minor":0}
</script>
</div>
</div>
<p>We can can now show what we previously calculated. The solid lines represent the clean trajectories while the shaded ones are the noisy. The dashed line in the left plot shows the expected scaling for subdiffusive trajectories while the point-dashed one is the expected scaling for normal and superdiffusive trajectories. The dashed line in the rightmost plot show the expected theoretical convergence for each type of diffusion. See more about this in <a href="https://www.nature.com/articles/s42005-022-01079-8">“Towards a robust criterion of anomalous diffusion”, V. Sposini et al.</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">14</span>,<span class="dv">6</span>), tight_layout <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idxH, H <span class="kw">in</span> <span class="bu">enumerate</span>((Hs)):</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">0</span>].loglog(f[<span class="dv">1</span>:], muH[idxH]<span class="op">/</span>muH[idxH,<span class="dv">0</span>], label <span class="op">=</span> <span class="vs">fr'$\alpha$ = </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">round</span>(H,<span class="dv">2</span>)<span class="op">*</span><span class="dv">2</span><span class="sc">}</span><span class="vs">'</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">0</span>].loglog(f[<span class="dv">1</span>:], muH_noise[idxH]<span class="op">/</span>muH_noise[idxH,<span class="dv">0</span>], c<span class="op">=</span><span class="ss">f'C</span><span class="sc">{</span>idxH<span class="sc">}</span><span class="ss">'</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> idxH <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>        ax[<span class="dv">0</span>].plot(np.linspace(<span class="fl">1e-4</span>, <span class="fl">1e-2</span>, <span class="dv">10</span>), <span class="fl">1e-6</span><span class="op">*</span>np.linspace(<span class="fl">1e-4</span>, <span class="fl">1e-2</span>, <span class="dv">10</span>)<span class="op">**</span>(<span class="op">-</span>H<span class="op">*</span><span class="dv">2</span><span class="op">-</span><span class="dv">1</span>), c <span class="op">=</span> <span class="st">'k'</span>, ls <span class="op">=</span> <span class="st">'--'</span>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> idxH <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>        ax[<span class="dv">0</span>].plot(np.linspace(<span class="fl">1e-4</span>, <span class="fl">1e-2</span>, <span class="dv">10</span>), <span class="fl">1e-11</span><span class="op">*</span>np.linspace(<span class="fl">1e-4</span>, <span class="fl">1e-2</span>, <span class="dv">10</span>)<span class="op">**</span>(<span class="op">-</span>H<span class="op">*</span><span class="dv">2</span><span class="op">-</span><span class="dv">1</span>), c <span class="op">=</span> <span class="st">'k'</span>, ls <span class="op">=</span> <span class="st">'-.'</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">1</span>].semilogx(f[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>], stdH[idxH, :<span class="op">-</span><span class="dv">1</span>]<span class="op">/</span> muH[idxH, :<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">1</span>].semilogx(f[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>], stdH_noise[idxH, :<span class="op">-</span><span class="dv">1</span>]<span class="op">/</span> muH_noise[idxH, :<span class="op">-</span><span class="dv">1</span>], c<span class="op">=</span><span class="ss">f'C</span><span class="sc">{</span>idxH<span class="sc">}</span><span class="ss">'</span>, alpha <span class="op">=</span> <span class="fl">0.6</span>)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> line <span class="kw">in</span> [<span class="dv">1</span>, np.sqrt(<span class="dv">2</span>), np.sqrt(<span class="dv">5</span>)<span class="op">/</span><span class="dv">2</span>]: ax[<span class="dv">1</span>].axhline(line, c<span class="op">=</span><span class="st">'k'</span>, ls <span class="op">=</span> <span class="st">'--'</span>, alpha <span class="op">=</span> <span class="fl">0.8</span>)</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>plt.setp(ax[<span class="dv">0</span>], </span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>         xlabel <span class="op">=</span> <span class="st">'f [Hz]'</span>,</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>         ylabel <span class="op">=</span> <span class="st">'PSD / PSD(f = 0)'</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>plt.setp(ax[<span class="dv">1</span>], </span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>         xlabel <span class="op">=</span> <span class="st">'f [Hz]'</span>,</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>         ylabel <span class="op">=</span> <span class="vs">r'$\gamma$'</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;matplotlib.legend.Legend&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="analysis_files/figure-html/cell-31-output-2.png" class="img-fluid"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script type="application/vnd.jupyter.widget-state+json">
{"state":{},"version_major":2,"version_minor":0}
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>