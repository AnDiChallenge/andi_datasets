<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ANDI - Benchmark Dataset of the 2nd AnDi Challenge</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta property="og:title" content="ANDI - Benchmark Dataset of the 2nd AnDi Challenge">
<meta property="og:description" content="In this notebook, we showcase how to generate the benchmark dataset of the 2nd AnDi Challenge. This dataset has been curated from the one used during the “Challenge phase” of the 2nd AnDi Challenge.">
<meta property="og:site-name" content="ANDI">
<meta name="twitter:title" content="ANDI - Benchmark Dataset of the 2nd AnDi Challenge">
<meta name="twitter:description" content="In this notebook, we showcase how to generate the benchmark dataset of the 2nd AnDi Challenge. This dataset has been curated from the one used during the “Challenge phase” of the 2nd AnDi Challenge.">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../figures/logos_banners/logo_noname.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ANDI</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../lib_nbs/index_docs.html">
 <span class="menu-text">Documentation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../tutorials/index_tutorials.html">
 <span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://andi-app.herokuapp.com/andi_app">
 <span class="menu-text">ANDI interactive tool</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/andichallenge/andi_datasets"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/AndiChallenge"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#loading-the-dataset" id="toc-loading-the-dataset" class="nav-link active" data-scroll-target="#loading-the-dataset">Loading the dataset</a></li>
  <li><a href="#structure-of-the-dataset" id="toc-structure-of-the-dataset" class="nav-link" data-scroll-target="#structure-of-the-dataset">Structure of the dataset</a></li>
  <li><a href="#generating-the-dataset" id="toc-generating-the-dataset" class="nav-link" data-scroll-target="#generating-the-dataset">Generating the dataset</a>
  <ul class="collapse">
  <li><a href="#experiment-parameters" id="toc-experiment-parameters" class="nav-link" data-scroll-target="#experiment-parameters">Experiment Parameters</a></li>
  <li><a href="#creating-dataset" id="toc-creating-dataset" class="nav-link" data-scroll-target="#creating-dataset">Creating dataset</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/andichallenge/andi_datasets/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Benchmark Dataset of the 2nd AnDi Challenge</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<p>In this notebook, we showcase how to generate the benchmark dataset of the 2nd AnDi Challenge. This dataset has been curated from the one used during the “Challenge phase” of the <a href="https://codalab.lisn.upsaclay.fr/competitions/16618">2nd AnDi Challenge</a>. The results of the challenge participants on these datasets are discussed in the associated <a href="https://doi.org/10.48550/arXiv.2311.18100">paper</a>. In this tutorial, we will demonstrate how to create the benchmark dataset from scratch. Throughout this notebook, we assume knowledge of the basics of the challenge. If you are new, we recommend checking the previous two tutorials, which you can find in <a href="../tutorials/challenge_two_datasets.html">this notebook</a> and <a href="../tutorials/challenge_two_submission.html">this notebook</a>.</p>
<blockquote class="blockquote">
<p><strong>Important note:</strong> This notebook complements the explanations provided in the section “Generating the ANDI 2 Challenge Dataset” of the second tutorial (<a href="../tutorials/challenge_two_submission.html">link again</a>). Here, we will cover only the dataset generation. To learn about file organization, expected files, and contents, please refer to that previous tutorial!</p>
</blockquote>
<section id="loading-the-dataset" class="level2">
<h2 class="anchored" data-anchor-id="loading-the-dataset">Loading the dataset</h2>
<p>In case you don’t want to generate the dataset yourself, you can find it <a href="https://doi.org/10.5281/zenodo.14281478">Zenodo</a>.</p>
</section>
<section id="structure-of-the-dataset" class="level2">
<h2 class="anchored" data-anchor-id="structure-of-the-dataset">Structure of the dataset</h2>
<p>The dataset consists of 9 experiments, designed to benchmark methods across various scenarios, with a strong focus on single-particle tracking experiments. For more on the biological motivation of this dataset, please see the paper. The first two experiments were designed to mimic typical biological scenarios, specifically:</p>
<ul>
<li><strong>EXP 1</strong>: Multistate model with 3 diffusive states inspired by this <a href="https://doi.org/10.1038/nature24264">T. Sungkaworn et al., Nature 550, 543–547 (2017)</a>.</li>
<li><strong>EXP 2</strong>: Dimerization model inspired by this <a href="https://doi.org/10.1038/nsmb.2135">S. Low-Nam et al., Nat Struct Mol Biol 18, 1244–1249 (2011</a>.</li>
</ul>
<p>Next, we consider a group of experiments with approximately the same diffusive parameters but different underlying diffusion models. This serves as a benchmark for methods’ ability to distinguish between different physical processes. This group includes three experiments, all of which share similar properties for the diffusive state, with variations in other states to mimic trapping:</p>
<ul>
<li><strong>EXP 3</strong>: Trapping with a normal diffusive state.</li>
<li><strong>EXP 4</strong>: Confinement with a small confinement radius and a slow confined diffusive state.</li>
<li><strong>EXP 5</strong>: Dimerization with a slow dimerized state.</li>
</ul>
<p>The second group evaluates methods’ ability to leverage the underlying physics of the diffusion model, especially in comparing two experiments with identical diffusive parameters but different underlying models:</p>
<ul>
<li><strong>EXP 6</strong>: Dimerization model.</li>
<li><strong>EXP 7</strong>: Multistate model.</li>
</ul>
<p>We also include two datasets aimed at testing specific strengths of characterization methods:</p>
<ul>
<li><strong>EXP 8</strong>: Single-state model with very broad <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(K\)</span> distributions. This allows for investigating false positives in changepoint detection and benchmarking methods in datasets without diffusive changes.</li>
<li><strong>EXP 9</strong>: Trapping model with very short trapping times and superdiffusion in the free state, assessing methods under extreme conditions.</li>
</ul>
<p>Here is a summary of each experiment’s parameters:</p>

<table style="font-size: 14px; text-align: center; border-collapse: collapse;">
<thead>
<tr style="border-top: 1px solid black;">
<th rowspan="2" style="width: 40px;">
EXP
</th>
<th rowspan="2">
Model
</th>
<th rowspan="2" style="width: 60px;">
# states
</th>
<th rowspan="2">
</th>
<th colspan="2" style="width: 150px;">
K (pixel<sup>2</sup>/frame<sup>α</sup>)
</th>
<th colspan="2" style="width: 150px;">
α
</th>
<th rowspan="2" style="width: 60px;">
Diff. class
</th>
<th rowspan="2">
Model-specific parameters
</th>
</tr>
<tr style="border-top: 1px solid black;">
<th>
μ
</th>
<th>
σ<sup>2</sup>
</th>
<th>
μ
</th>
<th>
σ<sup>2</sup>
</th>
</tr>
</thead>
<tbody>
<!-- Experiment 1 -->
<tr style="border-top: 1px solid black;">
<td rowspan="3">
1
</td>
<td rowspan="3">
MSM
</td>
<td rowspan="3">
3
</td>
<td>
1
</td>
<td>
0.15
</td>
<td>
0.01
</td>
<td>
1
</td>
<td>
0.0001
</td>
<td>
2
</td>
<td rowspan="3">
M = [[0.946, 0.024, 0.03], [0.016, 0.92, 0.064], [0.037, 0.14, 0.823]]
</td>
</tr>
<tr style="border-top: 0.1px solid black;">
<td>
2
</td>
<td>
0.33
</td>
<td>
0.001
</td>
<td>
1
</td>
<td>
0.01
</td>
<td>
2
</td>
</tr>
<tr style="border-top: 0.1px solid black;">
<td>
3
</td>
<td>
0.95
</td>
<td>
0.01
</td>
<td>
1
</td>
<td>
0.01
</td>
<td>
2
</td>
</tr>
<!-- Experiment 2 -->
<tr style="border-top: 1px solid black;">
<td rowspan="2">
2
</td>
<td rowspan="2">
DIM
</td>
<td rowspan="2">
2
</td>
<td>
1
</td>
<td>
0.28
</td>
<td>
0.001
</td>
<td>
1
</td>
<td>
0.1
</td>
<td>
2
</td>
<td rowspan="2">
r = 0.5, N = 750, P<sub>b</sub> = 1, P<sub>u</sub> = 0.1
</td>
</tr>
<tr style="border-top: 0.1px solid black;">
<td>
2
</td>
<td>
0.0035
</td>
<td>
0.0001
</td>
<td>
1.1
</td>
<td>
0.01
</td>
<td>
2
</td>
</tr>
<!-- Experiment 3 -->
<tr style="border-top: 1px solid black;">
<td rowspan="2">
3
</td>
<td rowspan="2">
QTM
</td>
<td rowspan="2">
2
</td>
<td>
1
</td>
<td>
1
</td>
<td>
0.1
</td>
<td>
1
</td>
<td>
0.005
</td>
<td>
2
</td>
<td rowspan="2">
r<sub>t</sub> = 0.4, N<sub>t</sub> = 500, P<sub>b</sub> = 0.7, P<sub>u</sub> = 1/60
</td>
</tr>
<tr style="border-top: 0.1px solid black;">
<td>
2
</td>
<td>
-
</td>
<td>
-
</td>
<td>
-
</td>
<td>
-
</td>
<td>
0
</td>
</tr>
<!-- Experiment 4 -->
<tr style="border-top: 1px solid black;">
<td rowspan="2">
4
</td>
<td rowspan="2">
TCM
</td>
<td rowspan="2">
2
</td>
<td>
1
</td>
<td>
1
</td>
<td>
0.1
</td>
<td>
1
</td>
<td>
0.005
</td>
<td>
2
</td>
<td rowspan="2">
r<sub>c</sub> = 2, N<sub>c</sub> = 150, T = 0.1
</td>
</tr>
<tr style="border-top: 0.1px solid black;">
<td>
2
</td>
<td>
0.01
</td>
<td>
0.001
</td>
<td>
0.2
</td>
<td>
0.001
</td>
<td>
1
</td>
</tr>
<!-- Experiment 5 -->
<tr style="border-top: 1px solid black;">
<td rowspan="2">
5
</td>
<td rowspan="2">
DIM
</td>
<td rowspan="2">
2
</td>
<td>
1
</td>
<td>
1
</td>
<td>
0.1
</td>
<td>
1
</td>
<td>
0.005
</td>
<td>
2
</td>
<td rowspan="2">
r = 0.35, N = 500, P<sub>b</sub> = 1, P<sub>u</sub> = 1/60
</td>
</tr>
<tr style="border-top: 0.1px solid black;">
<td>
2
</td>
<td>
0.01
</td>
<td>
0.001
</td>
<td>
0.2
</td>
<td>
0.001
</td>
<td>
2
</td>
</tr>
<!-- Experiment 6 -->
<tr style="border-top: 1px solid black;">
<td rowspan="2">
6
</td>
<td rowspan="2">
DIM
</td>
<td rowspan="2">
2
</td>
<td>
1
</td>
<td>
0.1
</td>
<td>
0.1
</td>
<td>
0.7
</td>
<td>
0.1
</td>
<td>
2
</td>
<td rowspan="2">
r = 1, N = 100, P<sub>b</sub> = 1, P<sub>u</sub> = 0.05
</td>
</tr>
<tr style="border-top: 0.1px solid black;">
<td>
2
</td>
<td>
1
</td>
<td>
0.01
</td>
<td>
1.2
</td>
<td>
0.01
</td>
<td>
2
</td>
</tr>
<!-- Experiment 7 -->
<tr style="border-top: 1px solid black;">
<td rowspan="2">
7
</td>
<td rowspan="2">
MSM
</td>
<td rowspan="2">
2
</td>
<td>
1
</td>
<td>
0.1
</td>
<td>
0.1
</td>
<td>
0.7
</td>
<td>
0.1
</td>
<td>
2
</td>
<td rowspan="2">
M = [[0.9833, 0.0167], [0.05, 0.95]]
</td>
</tr>
<tr style="border-top: 0.1px solid black;">
<td>
2
</td>
<td>
1
</td>
<td>
0.01
</td>
<td>
1.2
</td>
<td>
0.01
</td>
<td>
2
</td>
</tr>
<!-- Experiment 8 -->
<tr style="border-top: 1px solid black;">
<td>
8
</td>
<td>
SSM
</td>
<td>
1
</td>
<td>
1
</td>
<td>
1
</td>
<td>
100
</td>
<td>
1
</td>
<td>
10
</td>
<td>
2 / 3
</td>
<td>
-
</td>
</tr>
<!-- Experiment 9 -->
<tr style="border-top: 1px solid black;">
<td rowspan="2">
9
</td>
<td rowspan="2">
QTM
</td>
<td rowspan="2">
2
</td>
<td>
1
</td>
<td>
1
</td>
<td>
0.01
</td>
<td>
1.99
</td>
<td>
0.01
</td>
<td>
2 / 3
</td>
<td rowspan="2">
r<sub>c</sub> = 1.5, N<sub>t</sub> = 1000, P<sub>b</sub> = 0.7, P<sub>u</sub> = 1/5
</td>
</tr>
<tr style="border-top: 0.1px solid black;">
<td>
2
</td>
<td>
-
</td>
<td>
-
</td>
<td>
-
</td>
<td>
-
</td>
<td>
0
</td>
</tr>
</tbody>

</table>
</section>
<section id="generating-the-dataset" class="level1">
<h1>Generating the dataset</h1>
<p>Here we showcase, step by step, how to generate the benchmark dataset. This will allow us to explore the experiments as we define them. Also, it may helpful in case you want to generate a dataset of similar structure with different diffusive models / parameters.</p>
<p>We start by importing the necessary libraries:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> andi_datasets.datasets_challenge <span class="im">import</span> _defaults_andi2, challenge_phenom_dataset, _get_dic_andi2</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> andi_datasets.utils_challenge <span class="im">import</span> multimode_dist</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> andi_datasets.models_phenom <span class="im">import</span> models_phenom</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> andi_datasets.utils_challenge <span class="im">import</span> file_nonOverlap_reOrg</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># For visualization</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In case you want to have EXACTLY the same dataset as the one shared, you need to fix the seeds of both <code>numpy</code> and <code>stochastic</code>. The latter works in the background for the generation of the fractional Brownian motion trajectories.</p>
<p>Note: the generated data will only the same as the shared one if you run the cells from here on only once and in the designated order.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">12112024</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> stochastic</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>stochastic.random.seed(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="experiment-parameters" class="level3">
<h3 class="anchored" data-anchor-id="experiment-parameters">Experiment Parameters</h3>
<p>We define now the parameters for each experiment. As done in previous tutorials, we will generate for each experiment a dictionary containing its specific parameters. As you will see, most of the parameters come from the default parameters, which can be found at <code>_defaults_andi2()</code>. We will then store all these dictionaries in a list <code>dics</code> that will be later passed to the function <a href="https://andichallenge.github.io/andi_datasets/lib_nbs/datasets_challenge.html#challenge_phenom_dataset"><code>challenge_phenom_dataset</code></a> from <code>andi_datasets.datasets_challenge</code>.</p>
<p>As we generate the different experiments we will plot the distribution of diffusive parameters to check that everything runs smoothly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dics <span class="op">=</span> []</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>num_exps <span class="op">=</span> <span class="dv">9</span> <span class="co"># Number of experiments we will generate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="exp-1" class="level4">
<h4 class="anchored" data-anchor-id="exp-1">EXP 1</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Ds_exp1 <span class="op">=</span> np.array([[<span class="fl">0.15</span>, <span class="fl">0.01</span>],</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>               [<span class="fl">0.33</span>, <span class="fl">0.001</span>],</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>               [<span class="fl">0.95</span>, <span class="fl">0.01</span>]])</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>alphas_exp1 <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="fl">0.0001</span>],</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                      [<span class="dv">1</span>, <span class="fl">0.01</span>],</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                      [<span class="dv">1</span>, <span class="fl">0.01</span>]])</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Transition probabilities</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>p12 <span class="op">=</span> <span class="fl">0.024</span><span class="op">;</span> p13 <span class="op">=</span> <span class="fl">0.03</span><span class="op">;</span> </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>p11 <span class="op">=</span> <span class="dv">1</span><span class="op">-</span>p12<span class="op">-</span>p13</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>p21 <span class="op">=</span> <span class="fl">0.016</span><span class="op">;</span> p23 <span class="op">=</span> <span class="fl">0.064</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>p22 <span class="op">=</span> <span class="dv">1</span><span class="op">-</span>p21<span class="op">-</span>p23</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>p31 <span class="op">=</span> <span class="fl">0.037</span><span class="op">;</span> p32 <span class="op">=</span> <span class="fl">0.140</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>p33 <span class="op">=</span> <span class="dv">1</span><span class="op">-</span>p31<span class="op">-</span>p32</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Transition matrix</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>M_exp1 <span class="op">=</span>  np.array([[p11, p12, p13],</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>               [p21, p22, p23],</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>               [p31, p32, p33],</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>              ])</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>dic_multi_exp1 <span class="op">=</span> _get_dic_andi2(<span class="dv">2</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>dic_multi_exp1[<span class="st">'M'</span>] <span class="op">=</span> M_exp1</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>dic_multi_exp1[<span class="st">'alphas'</span>] <span class="op">=</span> alphas_exp1</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>dic_multi_exp1[<span class="st">'Ds'</span>] <span class="op">=</span> Ds_exp1</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>dics.append(dic_multi_exp1)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="co">### plot pops parameters</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">6</span>,<span class="dv">3</span>))</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'EXP 1 - 3 states'</span>)</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="fl">0.001</span>,<span class="dv">2</span>,<span class="dv">1000</span>)</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> multimode_dist(Ds_exp1.tolist(), [<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>], bound <span class="op">=</span> [<span class="fl">1e-12</span>,<span class="fl">1e6</span>], x <span class="op">=</span> x)</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(x, dist)</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'K'</span>)<span class="op">;</span> <span class="co">#ax[0].set_xscale('log')</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1000</span>)</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> multimode_dist(alphas_exp1.tolist(), [<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>], bound <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">2</span>], x <span class="op">=</span> x)</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(x, dist)</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'alpha'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Text(0.5, 0, 'alpha')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="challenge_two_benchmark_files/figure-html/cell-5-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="exp-2" class="level4">
<h4 class="anchored" data-anchor-id="exp-2">EXP 2</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Ds_exp2 <span class="op">=</span> np.array([[<span class="fl">0.28</span>, <span class="fl">0.001</span>],</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                 [<span class="fl">0.0035</span>, <span class="fl">0.0001</span>]])</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>alphas_exp2 <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="fl">0.1</span>],</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                     [<span class="fl">1.1</span>, <span class="fl">0.01</span>]])</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>dic_dim_exp2 <span class="op">=</span> _get_dic_andi2(<span class="dv">4</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>dic_dim_exp2[<span class="st">'r'</span>] <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>dic_dim_exp2[<span class="st">'Pb'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>dic_dim_exp2[<span class="st">'Pu'</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>dic_dim_exp2[<span class="st">'N'</span>] <span class="op">=</span> _defaults_andi2().N<span class="op">*</span><span class="dv">15</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>dic_dim_exp2[<span class="st">'alphas'</span>] <span class="op">=</span> alphas_exp2</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>dic_dim_exp2[<span class="st">'Ds'</span>] <span class="op">=</span> Ds_exp2</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>dics.append(dic_dim_exp2)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">### plot pops parameters</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">6</span>,<span class="dv">3</span>))</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'EXP 2 - Dimerization'</span>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="fl">0.001</span>,<span class="fl">0.5</span>,<span class="dv">1000</span>)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> multimode_dist(Ds_exp2.tolist(), [<span class="fl">0.8</span>,<span class="fl">0.2</span>], bound <span class="op">=</span> [<span class="fl">1e-12</span>,<span class="fl">1e6</span>], x <span class="op">=</span> x)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(x, dist)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'K'</span>)<span class="op">;</span> <span class="co">#ax[0].set_xscale('log')</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1000</span>)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> multimode_dist(alphas_exp2.tolist(), [<span class="fl">0.8</span>,<span class="fl">0.2</span>], bound <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">2</span>], x <span class="op">=</span> x)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(x, dist)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'alpha'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Text(0.5, 0, 'alpha')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="challenge_two_benchmark_files/figure-html/cell-6-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="group-1-exp-3-4-and-5" class="level4">
<h4 class="anchored" data-anchor-id="group-1-exp-3-4-and-5">Group 1: EXP 3, 4 and 5</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Ds_g1 <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="fl">0.1</span>],</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                  [<span class="fl">0.01</span>, <span class="fl">0.001</span>]])</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>alphas_g1 <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="fl">0.005</span>],</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                      [<span class="fl">0.2</span>, <span class="fl">0.001</span>]])</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>res_time_trap <span class="op">=</span> <span class="dv">60</span> <span class="co"># Expected residence time in trapped state</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>dic_trap_g1 <span class="op">=</span> _get_dic_andi2(<span class="dv">3</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>dic_trap_g1[<span class="st">'Pb'</span>] <span class="op">=</span> <span class="fl">0.7</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>dic_trap_g1[<span class="st">'Pu'</span>] <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>res_time_trap</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>dic_trap_g1[<span class="st">'Nt'</span>] <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>dic_trap_g1[<span class="st">'Ds'</span>] <span class="op">=</span> Ds_g1[<span class="dv">0</span>]</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>dic_trap_g1[<span class="st">'alphas'</span>] <span class="op">=</span> alphas_g1[<span class="dv">0</span>]</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>dic_conf_g1 <span class="op">=</span> _get_dic_andi2(<span class="dv">5</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>dic_conf_g1[<span class="st">'r'</span>] <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>dic_conf_g1[<span class="st">'trans'</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>dic_conf_g1[<span class="st">'Nc'</span>] <span class="op">=</span> <span class="dv">150</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>dic_conf_g1[<span class="st">'alphas'</span>] <span class="op">=</span> alphas_g1</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>dic_conf_g1[<span class="st">'Ds'</span>] <span class="op">=</span> Ds_g1</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>dic_dim_g1 <span class="op">=</span> _get_dic_andi2(<span class="dv">4</span>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>dic_dim_g1[<span class="st">'r'</span>] <span class="op">=</span> <span class="fl">0.35</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>dic_dim_g1[<span class="st">'Pb'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>dic_dim_g1[<span class="st">'Pu'</span>] <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>res_time_trap</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>dic_dim_g1[<span class="st">'N'</span>] <span class="op">=</span> _defaults_andi2().N<span class="op">*</span><span class="dv">10</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>dic_dim_g1[<span class="st">'alphas'</span>] <span class="op">=</span> alphas_g1</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>dic_dim_g1[<span class="st">'Ds'</span>] <span class="op">=</span> Ds_g1</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>dics.append(dic_trap_g1)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>dics.append(dic_conf_g1)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>dics.append(dic_dim_g1)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="co">### plot pops parameters</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">6</span>,<span class="dv">3</span>))</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Group 1 - Mimicking trapping'</span>)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="fl">0.001</span>,<span class="dv">2</span>,<span class="dv">1000</span>)</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> multimode_dist(Ds_g1.tolist(), [<span class="fl">0.5</span>,<span class="fl">0.5</span>], bound <span class="op">=</span> [<span class="fl">1e-12</span>,<span class="fl">1e6</span>], x <span class="op">=</span> x)</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(x, dist)</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'K'</span>)</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1000</span>)</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> multimode_dist(alphas_g1.tolist(), [<span class="fl">0.5</span>,<span class="fl">0.5</span>], bound <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">2</span>], x <span class="op">=</span> x)</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(x, dist)</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'alpha'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Text(0.5, 0, 'alpha')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="challenge_two_benchmark_files/figure-html/cell-7-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="group-2-exp-6-and-7" class="level4">
<h4 class="anchored" data-anchor-id="group-2-exp-6-and-7">Group 2: EXP 6 and 7</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected residence time in each state and associated Pu</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>res1 <span class="op">=</span> <span class="fl">0.75</span><span class="op">;</span> res2 <span class="op">=</span> <span class="fl">0.25</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>Pu_g2 <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>res_time_dim <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>Pu_g2</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>res_time_free <span class="op">=</span> (res_time_dim)<span class="op">/</span>res2<span class="op">*</span>res1</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>P_dim <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>res_time_free</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>M_g2 <span class="op">=</span> np.array([[<span class="dv">1</span><span class="op">-</span>P_dim, P_dim], [Pu_g2, <span class="dv">1</span><span class="op">-</span>Pu_g2]])</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>alphas_g2 <span class="op">=</span> np.array([[<span class="fl">0.7</span>, <span class="fl">0.10</span>],</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>                      [<span class="fl">1.2</span>, <span class="fl">0.01</span>]])</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>Ds_g2 <span class="op">=</span> np.array([[<span class="fl">0.1</span>, <span class="fl">0.1</span>],</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>                  [<span class="fl">1.0</span>, <span class="fl">0.01</span>]])</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>dic_dim_g2 <span class="op">=</span> _get_dic_andi2(<span class="dv">4</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>dic_dim_g2[<span class="st">'r'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>dic_dim_g2[<span class="st">'Pb'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>dic_dim_g2[<span class="st">'Pu'</span>] <span class="op">=</span> Pu_g2</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>dic_dim_g2[<span class="st">'N'</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>dic_dim_g2[<span class="st">'alphas'</span>] <span class="op">=</span> alphas_g2</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>dic_dim_g2[<span class="st">'Ds'</span>] <span class="op">=</span> Ds_g2</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>dic_multi_g2 <span class="op">=</span> _get_dic_andi2(<span class="dv">2</span>)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>dic_multi_g2[<span class="st">'alphas'</span>] <span class="op">=</span> alphas_g2</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>dic_multi_g2[<span class="st">'Ds'</span>] <span class="op">=</span> Ds_g2</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>dic_multi_g2[<span class="st">'N'</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>dic_multi_g2[<span class="st">'M'</span>] <span class="op">=</span> M_g2</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>dics.append(dic_dim_g2)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>dics.append(dic_multi_g2)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="co">### plot pops parameters</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">6</span>,<span class="dv">3</span>))</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Group 2 - Multi vs. dimerization'</span>)</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="fl">0.001</span>,<span class="fl">1.5</span>,<span class="dv">1000</span>)</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> multimode_dist(Ds_g2.tolist(), [res1, res2], bound <span class="op">=</span> [<span class="fl">1e-12</span>,<span class="fl">1e6</span>], x <span class="op">=</span> x)</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(x, dist)</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'K'</span>)<span class="op">;</span> <span class="co">#ax[0].set_xscale('log')</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1000</span>)</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> multimode_dist(alphas_g2.tolist(), [res1, res2], bound <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">2</span>], x <span class="op">=</span> x)</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(x, dist)</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'alpha'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Text(0.5, 0, 'alpha')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="challenge_two_benchmark_files/figure-html/cell-8-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="exp-8" class="level4">
<h4 class="anchored" data-anchor-id="exp-8">EXP 8</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>dic_single_exp8 <span class="op">=</span> _get_dic_andi2(<span class="dv">1</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>dic_single_exp8[<span class="st">'alphas'</span>] <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">10</span>])</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>dic_single_exp8[<span class="st">'Ds'</span>] <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">100</span>])</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>dics.append(dic_single_exp8)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">### plot pops parameters</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">6</span>,<span class="dv">3</span>))</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'EXP 8 - Single'</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="fl">0.001</span>,<span class="dv">10</span>,<span class="dv">1000</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> multimode_dist(dic_single_exp8[<span class="st">'Ds'</span>].tolist(), <span class="dv">1</span>, bound <span class="op">=</span> [<span class="fl">1e-12</span>,<span class="fl">1e6</span>], x <span class="op">=</span> x)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(x, dist)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'K'</span>)<span class="op">;</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1000</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> multimode_dist(dic_single_exp8[<span class="st">'alphas'</span>].tolist(), <span class="dv">1</span>, bound <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">2</span>], x <span class="op">=</span> x)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(x, dist)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'alpha'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Text(0.5, 0, 'alpha')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="challenge_two_benchmark_files/figure-html/cell-9-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="exp-9" class="level4">
<h4 class="anchored" data-anchor-id="exp-9">EXP 9</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>dic_trap_exp9 <span class="op">=</span> _get_dic_andi2(<span class="dv">3</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>dic_trap_exp9[<span class="st">'Pb'</span>] <span class="op">=</span> <span class="fl">0.7</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>dic_trap_exp9[<span class="st">'Pu'</span>] <span class="op">=</span> <span class="dv">1</span><span class="op">/</span><span class="dv">5</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>dic_trap_exp9[<span class="st">'Nt'</span>] <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>dic_trap_exp9[<span class="st">'Ds'</span>] <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="fl">0.01</span>])</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>dic_trap_exp9[<span class="st">'alphas'</span>] <span class="op">=</span> np.array([<span class="fl">1.99</span>,<span class="fl">0.01</span>])</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>dic_trap_exp9[<span class="st">'r'</span>] <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>dics.append(dic_trap_exp9)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">### plot pops parameters</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">6</span>,<span class="dv">3</span>))</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'EXP 9 - Fast trapping'</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="fl">0.001</span>,<span class="dv">10</span>,<span class="dv">1000</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> multimode_dist(dic_trap_exp9[<span class="st">'Ds'</span>].tolist(), <span class="dv">1</span>, bound <span class="op">=</span> [<span class="fl">1e-12</span>,<span class="fl">1e6</span>], x <span class="op">=</span> x)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(x, dist)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'K'</span>)<span class="op">;</span> <span class="co">#ax[0].set_xscale('log')</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1000</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> multimode_dist(dic_trap_exp9[<span class="st">'alphas'</span>].tolist(), <span class="dv">1</span>, bound <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">2</span>], x <span class="op">=</span> x)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(x, dist)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'alpha'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Text(0.5, 0, 'alpha')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="challenge_two_benchmark_files/figure-html/cell-10-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="creating-dataset" class="level3">
<h3 class="anchored" data-anchor-id="creating-dataset">Creating dataset</h3>
<p>We will now created the different FOVs for each experiment. This follows the same structure as the one presented in the section “Generating the ANDI 2 challenge dataset” from this <a href="../tutorials/challenge_two_submission.html">tutorial notebook</a>, check that to understand better what we are doing here. In short, for each experiment, we will consider that each FOV comes from a different set of measurements (i.e.&nbsp;a separate experiment, all with same properties).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="bu">len</span>(dics) <span class="op">==</span> num_exps <span class="co"># Checking that dics has the correct number of experiments in it.</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>num_fovs <span class="op">=</span> <span class="dv">30</span> <span class="co"># Number of FOVs that will be generated.</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>dics_with_fovs <span class="op">=</span> []</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> dic <span class="kw">in</span> dics:</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> dic[<span class="st">'model'</span>] <span class="op">==</span> <span class="st">'confinement'</span>:</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_fovs):</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> dic[<span class="st">'N'</span>] <span class="op">&lt;</span> <span class="dv">100</span>:</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>                dic[<span class="st">'N'</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>            dic[<span class="st">'comp_center'</span>] <span class="op">=</span> models_phenom._distribute_circular_compartments(Nc <span class="op">=</span> dic[<span class="st">'Nc'</span>], r <span class="op">=</span> dic[<span class="st">'r'</span>], L <span class="op">=</span> dic[<span class="st">'L'</span>])</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>            dics_with_fovs.append(dic)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> dic[<span class="st">'model'</span>] <span class="op">==</span> <span class="st">'immobile_traps'</span>:</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_fovs):</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> dic[<span class="st">'N'</span>] <span class="op">&lt;</span> <span class="dv">100</span>:</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>                dic[<span class="st">'N'</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>            dic[<span class="st">'traps_pos'</span>] <span class="op">=</span> np.random.rand(dic[<span class="st">'Nt'</span>], <span class="dv">2</span>)<span class="op">*</span>dic[<span class="st">'L'</span>]</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>            dics_with_fovs.append(dic)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_fovs): </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> dic[<span class="st">'N'</span>] <span class="op">&lt;</span> <span class="dv">100</span>:</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>                dic[<span class="st">'N'</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>            dics_with_fovs.append(dic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We are now ready to call <a href="https://andichallenge.github.io/andi_datasets/lib_nbs/datasets_challenge.html#challenge_phenom_dataset"><code>challenge_phenom_dataset</code></a>. This make take few minutes, depending on your computer specs (it took ~10 mins. in a fairly good PC).</p>
<blockquote class="blockquote">
<p>We will set <code>return_timestep_labs = True</code> to force that in the generated <code>.csv</code> you can also find the value of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(K\)</span> per step. See the submission tutorial for more on the content of each file</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="bu">len</span>(dics_with_fovs) <span class="op">==</span> num_exps<span class="op">*</span>num_fovs</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The following checks that the properly initialize the random seeds and run the cells correctly (only once per cell and established order)</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># If you don't care about generating EXACTLY the same dataset, you can comment the next two lines</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> np.random.rand() <span class="op">==</span> <span class="fl">0.13983116679650354</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> models_phenom().disp_fbm(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)[<span class="dv">0</span>] <span class="op">==</span> <span class="op">-</span><span class="fl">1.5603561985561718</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>PATH <span class="op">=</span> <span class="st">'raw/'</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>generate_videos <span class="op">=</span> <span class="va">True</span> <span class="co"># if you don't want to produce videos, set this to False</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>challenge_phenom_dataset(save_data <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>                         dics <span class="op">=</span> dics_with_fovs,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>                         path <span class="op">=</span> PATH, </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>                         return_timestep_labs <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>                         num_fovs <span class="op">=</span> <span class="dv">1</span>, <span class="co"># because of non-overlapping fovs, this should be 1</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>                         num_vip<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>                         get_video <span class="op">=</span> generate_videos,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>                        )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now reorganize the files to have the same organization as the one proposed in the challenge.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>target_folder <span class="op">=</span> Path(<span class="st">'andi_benchmark/'</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>raw_folder <span class="op">=</span> Path(<span class="st">'raw/'</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>file_nonOverlap_reOrg(raw_folder <span class="op">=</span> raw_folder,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                      target_folder <span class="op">=</span> target_folder, </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>                      experiments <span class="op">=</span> np.arange(num_exps),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                      tracks<span class="op">=</span>[<span class="dv">1</span>,<span class="dv">2</span>],</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                      num_fovs <span class="op">=</span> num_fovs, save_labels<span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Because we generated this folders with python, experiments now run from 0 to 8. This</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># small code brings back the numbers to 1 to 9</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> track <span class="kw">in</span> [<span class="dv">1</span>,<span class="dv">2</span>]:</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    base_path <span class="op">=</span> target_folder.joinpath(<span class="ss">f'track_</span><span class="sc">{</span>track<span class="sc">}</span><span class="ss">'</span>)    </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> exp <span class="kw">in</span> <span class="bu">range</span>(num_exps)[::<span class="op">-</span><span class="dv">1</span>]: <span class="co"># we got reverse to avoid overwrittings</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>        old_folder <span class="op">=</span> base_path.joinpath(<span class="ss">f'exp_</span><span class="sc">{</span>exp<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>        new_folder <span class="op">=</span> base_path.joinpath(<span class="ss">f'exp_</span><span class="sc">{</span>exp <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> old_folder.exists():</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>            old_folder.rename(new_folder)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="co"># The prints will show you the population percentages of each experimenta, to check that every went as planned:</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Experiment 0: [0.31 0.47 0.22]
Experiment 1: [0.76 0.24]
Experiment 2: [0.11 0.89]
Experiment 3: [0.45 0.55]
Experiment 4: [0.69 0.31]
Experiment 5: [0.86 0.14]
Experiment 6: [0.75 0.25]
Experiment 7: 1.0
Experiment 8: [0.55 0.45]</code></pre>
</div>
</div>
<p>Enjoy playing with your generated dataset :) . As commented, to learn more about the folder structure of the dataset you just produced, visit <a href="../tutorials/challenge_two_submission.html">this tutorial</a>.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>